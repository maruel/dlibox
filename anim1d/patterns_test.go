// Copyright 2016 Marc-Antoine Ruel. All rights reserved.
// Use of this source code is governed under the Apache License, Version 2.0
// that can be found in the LICENSE file.

package anim1d

import (
	"testing"
	"time"

	"github.com/maruel/ut"
)

func TestStaticColor(t *testing.T) {
	p := &Color{255, 255, 255, 255}
	e := []expectation{{3 * time.Second, []Color{{255, 255, 255, 255}}}}
	testFrames(t, p, e)
}

/*
func TestGlow1(t *testing.T) {
	p := &Glow{[]Color{{255, 255, 255, 255}, {0, 0, 0, 255}}, 1}
	e := []expectation{
		{0, []Color{{0xFF, 0xFF, 0xFF, 0xFF}}},
		{250 * time.Millisecond, []Color{{0xBF, 0xBF, 0xBF, 0xFF}}},
		{500 * time.Millisecond, []Color{{0x7F, 0x7F, 0x7F, 0xFF}}},
		{750 * time.Millisecond, []Color{{0x3F, 0x3F, 0x3F, 0xFF}}},
		{1000 * time.Millisecond, []Color{{0x00, 0x00, 0x00, 0xFF}}},
	}
	testFrames(t, p, e)
}

func TestGlow2(t *testing.T) {
	p := &Glow{[]Color{{255, 255, 255, 255}, {0, 0, 0, 255}}, 0.1}
	e := []expectation{
		{0, []Color{{0xFF, 0xFF, 0xFF, 0xFF}}},
		{2500 * time.Millisecond, []Color{{0xBF, 0xBF, 0xBF, 0xFF}}},
		{5000 * time.Millisecond, []Color{{0x80, 0x80, 0x80, 0xFF}}},
		{7500 * time.Millisecond, []Color{{0x3F, 0x3F, 0x3F, 0xFF}}},
		{10000 * time.Millisecond, []Color{{0x00, 0x00, 0x00, 0xFF}}},
	}
	testFrames(t, p, e)
}
*/

func TestPingPong(t *testing.T) {
	a := Color{10, 10, 10, 10}
	b := Color{20, 20, 20, 20}
	p := &PingPong{[]Color{a, b}, Color{}, 1000}
	e := []expectation{
		{0, []Color{a, {}, {}}},
		{500 * time.Microsecond, []Color{a, {}, {}}},
		{1 * time.Millisecond, []Color{b, a, {}}},
		{2 * time.Millisecond, []Color{{}, b, a}},
		{3 * time.Millisecond, []Color{{}, a, b}},
		{4 * time.Millisecond, []Color{a, b, {}}},
		{5 * time.Millisecond, []Color{b, a, {}}},
		{6 * time.Millisecond, []Color{{}, b, a}},
	}
	testFrames(t, p, e)
}

func TestRepeated(t *testing.T) {
	a := Color{10, 10, 10, 10}
	b := Color{20, 20, 20, 20}
	c := Color{30, 30, 30, 30}
	p := &Repeated{[]Color{a, b, c}, 1000}
	e := []expectation{
		{0, []Color{a, b, c, a, b}},
		{500 * time.Microsecond, []Color{a, b, c, a, b}},
		{1 * time.Millisecond, []Color{c, a, b, c, a}},
		{2 * time.Millisecond, []Color{b, c, a, b, c}},
		{3 * time.Millisecond, []Color{a, b, c, a, b}},
		{4 * time.Millisecond, []Color{c, a, b, c, a}},
		{5 * time.Millisecond, []Color{b, c, a, b, c}},
		{6 * time.Millisecond, []Color{a, b, c, a, b}},
	}
	testFrames(t, p, e)
}

func TestRepeatedRev(t *testing.T) {
	// Works in reverse too.
	a := Color{10, 10, 10, 10}
	b := Color{20, 20, 20, 20}
	c := Color{30, 30, 30, 30}
	p := &Repeated{[]Color{a, b, c}, -1000}
	e := []expectation{
		{0, []Color{a, b, c, a, b}},
		{500 * time.Microsecond, []Color{a, b, c, a, b}},
		{1 * time.Millisecond, []Color{b, c, a, b, c}},
		{2 * time.Millisecond, []Color{c, a, b, c, a}},
		{3 * time.Millisecond, []Color{a, b, c, a, b}},
		{4 * time.Millisecond, []Color{b, c, a, b, c}},
		{5 * time.Millisecond, []Color{c, a, b, c, a}},
		{6 * time.Millisecond, []Color{a, b, c, a, b}},
	}
	testFrames(t, p, e)
}

func TestWaveLength2RGB(t *testing.T) {
	data := []struct {
		input    float32
		expected Color
	}{
		{379, Color{0x00, 0x00, 0x00, 0x00}},
		{380, Color{0xFF, 0x00, 0xFF, 0x1A}},
		{381, Color{0xFC, 0x00, 0xFF, 0x20}},
		{382, Color{0xF7, 0x00, 0xFF, 0x26}},
		{383, Color{0xF3, 0x00, 0xFF, 0x2C}},
		{384, Color{0xEF, 0x00, 0xFF, 0x31}},
		{385, Color{0xEB, 0x00, 0xFF, 0x37}},
		{386, Color{0xE6, 0x00, 0xFF, 0x3D}},
		{387, Color{0xE2, 0x00, 0xFF, 0x43}},
		{388, Color{0xDE, 0x00, 0xFF, 0x48}},
		{389, Color{0xDA, 0x00, 0xFF, 0x4E}},
		{390, Color{0xD5, 0x00, 0xFF, 0x54}},
		{391, Color{0xD1, 0x00, 0xFF, 0x5A}},
		{392, Color{0xCD, 0x00, 0xFF, 0x5F}},
		{393, Color{0xC9, 0x00, 0xFF, 0x65}},
		{394, Color{0xC4, 0x00, 0xFF, 0x6B}},
		{395, Color{0xC0, 0x00, 0xFF, 0x71}},
		{396, Color{0xBC, 0x00, 0xFF, 0x76}},
		{397, Color{0xB8, 0x00, 0xFF, 0x7C}},
		{398, Color{0xB3, 0x00, 0xFF, 0x82}},
		{399, Color{0xAF, 0x00, 0xFF, 0x88}},
		{400, Color{0xAB, 0x00, 0xFF, 0x8D}},
		{401, Color{0xA7, 0x00, 0xFF, 0x93}},
		{402, Color{0xA2, 0x00, 0xFF, 0x99}},
		{403, Color{0x9E, 0x00, 0xFF, 0x9E}},
		{404, Color{0x9A, 0x00, 0xFF, 0xA4}},
		{405, Color{0x96, 0x00, 0xFF, 0xAA}},
		{406, Color{0x91, 0x00, 0xFF, 0xB0}},
		{407, Color{0x8D, 0x00, 0xFF, 0xB5}},
		{408, Color{0x89, 0x00, 0xFF, 0xBB}},
		{409, Color{0x85, 0x00, 0xFF, 0xC1}},
		{410, Color{0x80, 0x00, 0xFF, 0xC7}},
		{411, Color{0x7C, 0x00, 0xFF, 0xCC}},
		{412, Color{0x78, 0x00, 0xFF, 0xD2}},
		{413, Color{0x74, 0x00, 0xFF, 0xD8}},
		{414, Color{0x6F, 0x00, 0xFF, 0xDE}},
		{415, Color{0x6B, 0x00, 0xFF, 0xE3}},
		{416, Color{0x67, 0x00, 0xFF, 0xE9}},
		{417, Color{0x63, 0x00, 0xFF, 0xEF}},
		{418, Color{0x5E, 0x00, 0xFF, 0xF5}},
		{419, Color{0x5A, 0x00, 0xFF, 0xFA}},
		{420, Color{0x56, 0x00, 0xFF, 0xFF}},
		{421, Color{0x52, 0x00, 0xFF, 0xFF}},
		{422, Color{0x4D, 0x00, 0xFF, 0xFF}},
		{423, Color{0x49, 0x00, 0xFF, 0xFF}},
		{424, Color{0x45, 0x00, 0xFF, 0xFF}},
		{425, Color{0x41, 0x00, 0xFF, 0xFF}},
		{426, Color{0x3C, 0x00, 0xFF, 0xFF}},
		{427, Color{0x38, 0x00, 0xFF, 0xFF}},
		{428, Color{0x34, 0x00, 0xFF, 0xFF}},
		{429, Color{0x30, 0x00, 0xFF, 0xFF}},
		{430, Color{0x2B, 0x00, 0xFF, 0xFF}},
		{431, Color{0x27, 0x00, 0xFF, 0xFF}},
		{432, Color{0x23, 0x00, 0xFF, 0xFF}},
		{433, Color{0x1F, 0x00, 0xFF, 0xFF}},
		{434, Color{0x1A, 0x00, 0xFF, 0xFF}},
		{435, Color{0x16, 0x00, 0xFF, 0xFF}},
		{436, Color{0x12, 0x00, 0xFF, 0xFF}},
		{437, Color{0x0E, 0x00, 0xFF, 0xFF}},
		{438, Color{0x09, 0x00, 0xFF, 0xFF}},
		{439, Color{0x05, 0x00, 0xFF, 0xFF}},
		{440, Color{0x00, 0x00, 0xFF, 0xFF}},
		{441, Color{0x00, 0x06, 0xFF, 0xFF}},
		{442, Color{0x00, 0x0B, 0xFF, 0xFF}},
		{443, Color{0x00, 0x10, 0xFF, 0xFF}},
		{444, Color{0x00, 0x15, 0xFF, 0xFF}},
		{445, Color{0x00, 0x1A, 0xFF, 0xFF}},
		{446, Color{0x00, 0x20, 0xFF, 0xFF}},
		{447, Color{0x00, 0x25, 0xFF, 0xFF}},
		{448, Color{0x00, 0x2A, 0xFF, 0xFF}},
		{449, Color{0x00, 0x2F, 0xFF, 0xFF}},
		{450, Color{0x00, 0x34, 0xFF, 0xFF}},
		{451, Color{0x00, 0x39, 0xFF, 0xFF}},
		{452, Color{0x00, 0x3E, 0xFF, 0xFF}},
		{453, Color{0x00, 0x43, 0xFF, 0xFF}},
		{454, Color{0x00, 0x48, 0xFF, 0xFF}},
		{455, Color{0x00, 0x4D, 0xFF, 0xFF}},
		{456, Color{0x00, 0x53, 0xFF, 0xFF}},
		{457, Color{0x00, 0x58, 0xFF, 0xFF}},
		{458, Color{0x00, 0x5D, 0xFF, 0xFF}},
		{459, Color{0x00, 0x62, 0xFF, 0xFF}},
		{460, Color{0x00, 0x67, 0xFF, 0xFF}},
		{461, Color{0x00, 0x6C, 0xFF, 0xFF}},
		{462, Color{0x00, 0x71, 0xFF, 0xFF}},
		{463, Color{0x00, 0x76, 0xFF, 0xFF}},
		{464, Color{0x00, 0x7B, 0xFF, 0xFF}},
		{465, Color{0x00, 0x80, 0xFF, 0xFF}},
		{466, Color{0x00, 0x86, 0xFF, 0xFF}},
		{467, Color{0x00, 0x8B, 0xFF, 0xFF}},
		{468, Color{0x00, 0x90, 0xFF, 0xFF}},
		{469, Color{0x00, 0x95, 0xFF, 0xFF}},
		{470, Color{0x00, 0x9A, 0xFF, 0xFF}},
		{471, Color{0x00, 0x9F, 0xFF, 0xFF}},
		{472, Color{0x00, 0xA4, 0xFF, 0xFF}},
		{473, Color{0x00, 0xA9, 0xFF, 0xFF}},
		{474, Color{0x00, 0xAE, 0xFF, 0xFF}},
		{475, Color{0x00, 0xB3, 0xFF, 0xFF}},
		{476, Color{0x00, 0xB9, 0xFF, 0xFF}},
		{477, Color{0x00, 0xBE, 0xFF, 0xFF}},
		{478, Color{0x00, 0xC3, 0xFF, 0xFF}},
		{479, Color{0x00, 0xC8, 0xFF, 0xFF}},
		{480, Color{0x00, 0xCD, 0xFF, 0xFF}},
		{481, Color{0x00, 0xD2, 0xFF, 0xFF}},
		{482, Color{0x00, 0xD7, 0xFF, 0xFF}},
		{483, Color{0x00, 0xDC, 0xFF, 0xFF}},
		{484, Color{0x00, 0xE1, 0xFF, 0xFF}},
		{485, Color{0x00, 0xE6, 0xFF, 0xFF}},
		{486, Color{0x00, 0xEC, 0xFF, 0xFF}},
		{487, Color{0x00, 0xF1, 0xFF, 0xFF}},
		{488, Color{0x00, 0xF6, 0xFF, 0xFF}},
		{489, Color{0x00, 0xFB, 0xFF, 0xFF}},
		{490, Color{0x00, 0xFF, 0xFF, 0xFF}},
		{491, Color{0x00, 0xFF, 0xF3, 0xFF}},
		{492, Color{0x00, 0xFF, 0xE6, 0xFF}},
		{493, Color{0x00, 0xFF, 0xDA, 0xFF}},
		{494, Color{0x00, 0xFF, 0xCD, 0xFF}},
		{495, Color{0x00, 0xFF, 0xC0, 0xFF}},
		{496, Color{0x00, 0xFF, 0xB3, 0xFF}},
		{497, Color{0x00, 0xFF, 0xA7, 0xFF}},
		{498, Color{0x00, 0xFF, 0x9A, 0xFF}},
		{499, Color{0x00, 0xFF, 0x8D, 0xFF}},
		{500, Color{0x00, 0xFF, 0x80, 0xFF}},
		{501, Color{0x00, 0xFF, 0x74, 0xFF}},
		{502, Color{0x00, 0xFF, 0x67, 0xFF}},
		{503, Color{0x00, 0xFF, 0x5A, 0xFF}},
		{504, Color{0x00, 0xFF, 0x4D, 0xFF}},
		{505, Color{0x00, 0xFF, 0x41, 0xFF}},
		{506, Color{0x00, 0xFF, 0x34, 0xFF}},
		{507, Color{0x00, 0xFF, 0x27, 0xFF}},
		{508, Color{0x00, 0xFF, 0x1A, 0xFF}},
		{509, Color{0x00, 0xFF, 0x0E, 0xFF}},
		{510, Color{0x00, 0xFF, 0x00, 0xFF}},
		{511, Color{0x05, 0xFF, 0x00, 0xFF}},
		{512, Color{0x08, 0xFF, 0x00, 0xFF}},
		{513, Color{0x0C, 0xFF, 0x00, 0xFF}},
		{514, Color{0x10, 0xFF, 0x00, 0xFF}},
		{515, Color{0x13, 0xFF, 0x00, 0xFF}},
		{516, Color{0x17, 0xFF, 0x00, 0xFF}},
		{517, Color{0x1A, 0xFF, 0x00, 0xFF}},
		{518, Color{0x1E, 0xFF, 0x00, 0xFF}},
		{519, Color{0x22, 0xFF, 0x00, 0xFF}},
		{520, Color{0x25, 0xFF, 0x00, 0xFF}},
		{521, Color{0x29, 0xFF, 0x00, 0xFF}},
		{522, Color{0x2D, 0xFF, 0x00, 0xFF}},
		{523, Color{0x30, 0xFF, 0x00, 0xFF}},
		{524, Color{0x34, 0xFF, 0x00, 0xFF}},
		{525, Color{0x38, 0xFF, 0x00, 0xFF}},
		{526, Color{0x3B, 0xFF, 0x00, 0xFF}},
		{527, Color{0x3F, 0xFF, 0x00, 0xFF}},
		{528, Color{0x43, 0xFF, 0x00, 0xFF}},
		{529, Color{0x46, 0xFF, 0x00, 0xFF}},
		{530, Color{0x4A, 0xFF, 0x00, 0xFF}},
		{531, Color{0x4D, 0xFF, 0x00, 0xFF}},
		{532, Color{0x51, 0xFF, 0x00, 0xFF}},
		{533, Color{0x55, 0xFF, 0x00, 0xFF}},
		{534, Color{0x58, 0xFF, 0x00, 0xFF}},
		{535, Color{0x5C, 0xFF, 0x00, 0xFF}},
		{536, Color{0x60, 0xFF, 0x00, 0xFF}},
		{537, Color{0x63, 0xFF, 0x00, 0xFF}},
		{538, Color{0x67, 0xFF, 0x00, 0xFF}},
		{539, Color{0x6B, 0xFF, 0x00, 0xFF}},
		{540, Color{0x6E, 0xFF, 0x00, 0xFF}},
		{541, Color{0x72, 0xFF, 0x00, 0xFF}},
		{542, Color{0x76, 0xFF, 0x00, 0xFF}},
		{543, Color{0x79, 0xFF, 0x00, 0xFF}},
		{544, Color{0x7D, 0xFF, 0x00, 0xFF}},
		{545, Color{0x80, 0xFF, 0x00, 0xFF}},
		{546, Color{0x84, 0xFF, 0x00, 0xFF}},
		{547, Color{0x88, 0xFF, 0x00, 0xFF}},
		{548, Color{0x8B, 0xFF, 0x00, 0xFF}},
		{549, Color{0x8F, 0xFF, 0x00, 0xFF}},
		{550, Color{0x93, 0xFF, 0x00, 0xFF}},
		{551, Color{0x96, 0xFF, 0x00, 0xFF}},
		{552, Color{0x9A, 0xFF, 0x00, 0xFF}},
		{553, Color{0x9E, 0xFF, 0x00, 0xFF}},
		{554, Color{0xA1, 0xFF, 0x00, 0xFF}},
		{555, Color{0xA5, 0xFF, 0x00, 0xFF}},
		{556, Color{0xA9, 0xFF, 0x00, 0xFF}},
		{557, Color{0xAC, 0xFF, 0x00, 0xFF}},
		{558, Color{0xB0, 0xFF, 0x00, 0xFF}},
		{559, Color{0xB3, 0xFF, 0x00, 0xFF}},
		{560, Color{0xB7, 0xFF, 0x00, 0xFF}},
		{561, Color{0xBB, 0xFF, 0x00, 0xFF}},
		{562, Color{0xBE, 0xFF, 0x00, 0xFF}},
		{563, Color{0xC2, 0xFF, 0x00, 0xFF}},
		{564, Color{0xC6, 0xFF, 0x00, 0xFF}},
		{565, Color{0xC9, 0xFF, 0x00, 0xFF}},
		{566, Color{0xCD, 0xFF, 0x00, 0xFF}},
		{567, Color{0xD1, 0xFF, 0x00, 0xFF}},
		{568, Color{0xD4, 0xFF, 0x00, 0xFF}},
		{569, Color{0xD8, 0xFF, 0x00, 0xFF}},
		{570, Color{0xDC, 0xFF, 0x00, 0xFF}},
		{571, Color{0xDF, 0xFF, 0x00, 0xFF}},
		{572, Color{0xE3, 0xFF, 0x00, 0xFF}},
		{573, Color{0xE6, 0xFF, 0x00, 0xFF}},
		{574, Color{0xEA, 0xFF, 0x00, 0xFF}},
		{575, Color{0xEE, 0xFF, 0x00, 0xFF}},
		{576, Color{0xF1, 0xFF, 0x00, 0xFF}},
		{577, Color{0xF5, 0xFF, 0x00, 0xFF}},
		{578, Color{0xF9, 0xFF, 0x00, 0xFF}},
		{579, Color{0xFC, 0xFF, 0x00, 0xFF}},
		{580, Color{0xFF, 0xFF, 0x00, 0xFF}},
		{581, Color{0xFF, 0xFC, 0x00, 0xFF}},
		{582, Color{0xFF, 0xF8, 0x00, 0xFF}},
		{583, Color{0xFF, 0xF4, 0x00, 0xFF}},
		{584, Color{0xFF, 0xF0, 0x00, 0xFF}},
		{585, Color{0xFF, 0xEC, 0x00, 0xFF}},
		{586, Color{0xFF, 0xE8, 0x00, 0xFF}},
		{587, Color{0xFF, 0xE5, 0x00, 0xFF}},
		{588, Color{0xFF, 0xE1, 0x00, 0xFF}},
		{589, Color{0xFF, 0xDD, 0x00, 0xFF}},
		{590, Color{0xFF, 0xD9, 0x00, 0xFF}},
		{591, Color{0xFF, 0xD5, 0x00, 0xFF}},
		{592, Color{0xFF, 0xD1, 0x00, 0xFF}},
		{593, Color{0xFF, 0xCD, 0x00, 0xFF}},
		{594, Color{0xFF, 0xC9, 0x00, 0xFF}},
		{595, Color{0xFF, 0xC5, 0x00, 0xFF}},
		{596, Color{0xFF, 0xC1, 0x00, 0xFF}},
		{597, Color{0xFF, 0xBD, 0x00, 0xFF}},
		{598, Color{0xFF, 0xB9, 0x00, 0xFF}},
		{599, Color{0xFF, 0xB5, 0x00, 0xFF}},
		{600, Color{0xFF, 0xB2, 0x00, 0xFF}},
		{601, Color{0xFF, 0xAE, 0x00, 0xFF}},
		{602, Color{0xFF, 0xAA, 0x00, 0xFF}},
		{603, Color{0xFF, 0xA6, 0x00, 0xFF}},
		{604, Color{0xFF, 0xA2, 0x00, 0xFF}},
		{605, Color{0xFF, 0x9E, 0x00, 0xFF}},
		{606, Color{0xFF, 0x9A, 0x00, 0xFF}},
		{607, Color{0xFF, 0x96, 0x00, 0xFF}},
		{608, Color{0xFF, 0x92, 0x00, 0xFF}},
		{609, Color{0xFF, 0x8E, 0x00, 0xFF}},
		{610, Color{0xFF, 0x8A, 0x00, 0xFF}},
		{611, Color{0xFF, 0x86, 0x00, 0xFF}},
		{612, Color{0xFF, 0x82, 0x00, 0xFF}},
		{613, Color{0xFF, 0x7F, 0x00, 0xFF}},
		{614, Color{0xFF, 0x7B, 0x00, 0xFF}},
		{615, Color{0xFF, 0x77, 0x00, 0xFF}},
		{616, Color{0xFF, 0x73, 0x00, 0xFF}},
		{617, Color{0xFF, 0x6F, 0x00, 0xFF}},
		{618, Color{0xFF, 0x6B, 0x00, 0xFF}},
		{619, Color{0xFF, 0x67, 0x00, 0xFF}},
		{620, Color{0xFF, 0x63, 0x00, 0xFF}},
		{621, Color{0xFF, 0x5F, 0x00, 0xFF}},
		{622, Color{0xFF, 0x5B, 0x00, 0xFF}},
		{623, Color{0xFF, 0x57, 0x00, 0xFF}},
		{624, Color{0xFF, 0x53, 0x00, 0xFF}},
		{625, Color{0xFF, 0x4F, 0x00, 0xFF}},
		{626, Color{0xFF, 0x4C, 0x00, 0xFF}},
		{627, Color{0xFF, 0x48, 0x00, 0xFF}},
		{628, Color{0xFF, 0x44, 0x00, 0xFF}},
		{629, Color{0xFF, 0x40, 0x00, 0xFF}},
		{630, Color{0xFF, 0x3C, 0x00, 0xFF}},
		{631, Color{0xFF, 0x38, 0x00, 0xFF}},
		{632, Color{0xFF, 0x34, 0x00, 0xFF}},
		{633, Color{0xFF, 0x30, 0x00, 0xFF}},
		{634, Color{0xFF, 0x2C, 0x00, 0xFF}},
		{635, Color{0xFF, 0x28, 0x00, 0xFF}},
		{636, Color{0xFF, 0x24, 0x00, 0xFF}},
		{637, Color{0xFF, 0x20, 0x00, 0xFF}},
		{638, Color{0xFF, 0x1C, 0x00, 0xFF}},
		{639, Color{0xFF, 0x19, 0x00, 0xFF}},
		{640, Color{0xFF, 0x15, 0x00, 0xFF}},
		{641, Color{0xFF, 0x11, 0x00, 0xFF}},
		{642, Color{0xFF, 0x0D, 0x00, 0xFF}},
		{643, Color{0xFF, 0x09, 0x00, 0xFF}},
		{644, Color{0xFF, 0x05, 0x00, 0xFF}},
		{645, Color{0xFF, 0x00, 0x00, 0xFF}},
		{646, Color{0xFF, 0x00, 0x00, 0xFF}},
		{647, Color{0xFF, 0x00, 0x00, 0xFF}},
		{648, Color{0xFF, 0x00, 0x00, 0xFF}},
		{649, Color{0xFF, 0x00, 0x00, 0xFF}},
		{650, Color{0xFF, 0x00, 0x00, 0xFF}},
		{651, Color{0xFF, 0x00, 0x00, 0xFF}},
		{652, Color{0xFF, 0x00, 0x00, 0xFF}},
		{653, Color{0xFF, 0x00, 0x00, 0xFF}},
		{654, Color{0xFF, 0x00, 0x00, 0xFF}},
		{655, Color{0xFF, 0x00, 0x00, 0xFF}},
		{656, Color{0xFF, 0x00, 0x00, 0xFF}},
		{657, Color{0xFF, 0x00, 0x00, 0xFF}},
		{658, Color{0xFF, 0x00, 0x00, 0xFF}},
		{659, Color{0xFF, 0x00, 0x00, 0xFF}},
		{660, Color{0xFF, 0x00, 0x00, 0xFF}},
		{661, Color{0xFF, 0x00, 0x00, 0xFF}},
		{662, Color{0xFF, 0x00, 0x00, 0xFF}},
		{663, Color{0xFF, 0x00, 0x00, 0xFF}},
		{664, Color{0xFF, 0x00, 0x00, 0xFF}},
		{665, Color{0xFF, 0x00, 0x00, 0xFF}},
		{666, Color{0xFF, 0x00, 0x00, 0xFF}},
		{667, Color{0xFF, 0x00, 0x00, 0xFF}},
		{668, Color{0xFF, 0x00, 0x00, 0xFF}},
		{669, Color{0xFF, 0x00, 0x00, 0xFF}},
		{670, Color{0xFF, 0x00, 0x00, 0xFF}},
		{671, Color{0xFF, 0x00, 0x00, 0xFF}},
		{672, Color{0xFF, 0x00, 0x00, 0xFF}},
		{673, Color{0xFF, 0x00, 0x00, 0xFF}},
		{674, Color{0xFF, 0x00, 0x00, 0xFF}},
		{675, Color{0xFF, 0x00, 0x00, 0xFF}},
		{676, Color{0xFF, 0x00, 0x00, 0xFF}},
		{677, Color{0xFF, 0x00, 0x00, 0xFF}},
		{678, Color{0xFF, 0x00, 0x00, 0xFF}},
		{679, Color{0xFF, 0x00, 0x00, 0xFF}},
		{680, Color{0xFF, 0x00, 0x00, 0xFF}},
		{681, Color{0xFF, 0x00, 0x00, 0xFF}},
		{682, Color{0xFF, 0x00, 0x00, 0xFF}},
		{683, Color{0xFF, 0x00, 0x00, 0xFF}},
		{684, Color{0xFF, 0x00, 0x00, 0xFF}},
		{685, Color{0xFF, 0x00, 0x00, 0xFF}},
		{686, Color{0xFF, 0x00, 0x00, 0xFF}},
		{687, Color{0xFF, 0x00, 0x00, 0xFF}},
		{688, Color{0xFF, 0x00, 0x00, 0xFF}},
		{689, Color{0xFF, 0x00, 0x00, 0xFF}},
		{690, Color{0xFF, 0x00, 0x00, 0xFF}},
		{691, Color{0xFF, 0x00, 0x00, 0xFF}},
		{692, Color{0xFF, 0x00, 0x00, 0xFF}},
		{693, Color{0xFF, 0x00, 0x00, 0xFF}},
		{694, Color{0xFF, 0x00, 0x00, 0xFF}},
		{695, Color{0xFF, 0x00, 0x00, 0xFF}},
		{696, Color{0xFF, 0x00, 0x00, 0xFF}},
		{697, Color{0xFF, 0x00, 0x00, 0xFF}},
		{698, Color{0xFF, 0x00, 0x00, 0xFF}},
		{699, Color{0xFF, 0x00, 0x00, 0xFF}},
		{700, Color{0xFF, 0x00, 0x00, 0xFF}},
		{701, Color{0xFF, 0x00, 0x00, 0xFD}},
		{702, Color{0xFF, 0x00, 0x00, 0xFA}},
		{703, Color{0xFF, 0x00, 0x00, 0xF7}},
		{704, Color{0xFF, 0x00, 0x00, 0xF5}},
		{705, Color{0xFF, 0x00, 0x00, 0xF2}},
		{706, Color{0xFF, 0x00, 0x00, 0xEF}},
		{707, Color{0xFF, 0x00, 0x00, 0xEC}},
		{708, Color{0xFF, 0x00, 0x00, 0xE9}},
		{709, Color{0xFF, 0x00, 0x00, 0xE6}},
		{710, Color{0xFF, 0x00, 0x00, 0xE3}},
		{711, Color{0xFF, 0x00, 0x00, 0xE0}},
		{712, Color{0xFF, 0x00, 0x00, 0xDE}},
		{713, Color{0xFF, 0x00, 0x00, 0xDB}},
		{714, Color{0xFF, 0x00, 0x00, 0xD8}},
		{715, Color{0xFF, 0x00, 0x00, 0xD5}},
		{716, Color{0xFF, 0x00, 0x00, 0xD2}},
		{717, Color{0xFF, 0x00, 0x00, 0xCF}},
		{718, Color{0xFF, 0x00, 0x00, 0xCC}},
		{719, Color{0xFF, 0x00, 0x00, 0xC9}},
		{720, Color{0xFF, 0x00, 0x00, 0xC7}},
		{721, Color{0xFF, 0x00, 0x00, 0xC4}},
		{722, Color{0xFF, 0x00, 0x00, 0xC1}},
		{723, Color{0xFF, 0x00, 0x00, 0xBE}},
		{724, Color{0xFF, 0x00, 0x00, 0xBB}},
		{725, Color{0xFF, 0x00, 0x00, 0xB8}},
		{726, Color{0xFF, 0x00, 0x00, 0xB5}},
		{727, Color{0xFF, 0x00, 0x00, 0xB3}},
		{728, Color{0xFF, 0x00, 0x00, 0xB0}},
		{729, Color{0xFF, 0x00, 0x00, 0xAD}},
		{730, Color{0xFF, 0x00, 0x00, 0xAA}},
		{731, Color{0xFF, 0x00, 0x00, 0xA7}},
		{732, Color{0xFF, 0x00, 0x00, 0xA4}},
		{733, Color{0xFF, 0x00, 0x00, 0xA1}},
		{734, Color{0xFF, 0x00, 0x00, 0x9E}},
		{735, Color{0xFF, 0x00, 0x00, 0x9C}},
		{736, Color{0xFF, 0x00, 0x00, 0x99}},
		{737, Color{0xFF, 0x00, 0x00, 0x96}},
		{738, Color{0xFF, 0x00, 0x00, 0x93}},
		{739, Color{0xFF, 0x00, 0x00, 0x90}},
		{740, Color{0xFF, 0x00, 0x00, 0x8D}},
		{741, Color{0xFF, 0x00, 0x00, 0x8A}},
		{742, Color{0xFF, 0x00, 0x00, 0x88}},
		{743, Color{0xFF, 0x00, 0x00, 0x85}},
		{744, Color{0xFF, 0x00, 0x00, 0x82}},
		{745, Color{0xFF, 0x00, 0x00, 0x7F}},
		{746, Color{0xFF, 0x00, 0x00, 0x7C}},
		{747, Color{0xFF, 0x00, 0x00, 0x79}},
		{748, Color{0xFF, 0x00, 0x00, 0x76}},
		{749, Color{0xFF, 0x00, 0x00, 0x73}},
		{750, Color{0xFF, 0x00, 0x00, 0x71}},
		{751, Color{0xFF, 0x00, 0x00, 0x6E}},
		{752, Color{0xFF, 0x00, 0x00, 0x6B}},
		{753, Color{0xFF, 0x00, 0x00, 0x68}},
		{754, Color{0xFF, 0x00, 0x00, 0x65}},
		{755, Color{0xFF, 0x00, 0x00, 0x62}},
		{756, Color{0xFF, 0x00, 0x00, 0x5F}},
		{757, Color{0xFF, 0x00, 0x00, 0x5C}},
		{758, Color{0xFF, 0x00, 0x00, 0x5A}},
		{759, Color{0xFF, 0x00, 0x00, 0x57}},
		{760, Color{0xFF, 0x00, 0x00, 0x54}},
		{761, Color{0xFF, 0x00, 0x00, 0x51}},
		{762, Color{0xFF, 0x00, 0x00, 0x4E}},
		{763, Color{0xFF, 0x00, 0x00, 0x4B}},
		{764, Color{0xFF, 0x00, 0x00, 0x48}},
		{765, Color{0xFF, 0x00, 0x00, 0x46}},
		{766, Color{0xFF, 0x00, 0x00, 0x43}},
		{767, Color{0xFF, 0x00, 0x00, 0x40}},
		{768, Color{0xFF, 0x00, 0x00, 0x3D}},
		{769, Color{0xFF, 0x00, 0x00, 0x3A}},
		{770, Color{0xFF, 0x00, 0x00, 0x37}},
		{771, Color{0xFF, 0x00, 0x00, 0x34}},
		{772, Color{0xFF, 0x00, 0x00, 0x31}},
		{773, Color{0xFF, 0x00, 0x00, 0x2F}},
		{774, Color{0xFF, 0x00, 0x00, 0x2C}},
		{775, Color{0xFF, 0x00, 0x00, 0x29}},
		{776, Color{0xFF, 0x00, 0x00, 0x26}},
		{777, Color{0xFF, 0x00, 0x00, 0x23}},
		{778, Color{0xFF, 0x00, 0x00, 0x20}},
		{779, Color{0xFF, 0x00, 0x00, 0x1D}},
		{780, Color{0xFF, 0x00, 0x00, 0x1A}},
		{781, Color{0x00, 0x00, 0x00, 0x00}},
	}
	/*
		for _, line := range data {
			c := waveLength2RGB(line.input)
			fmt.Printf("{%d, Color{0x%02X, 0x%02X, 0x%02X, 0x%02X}},\n", int(line.input), c.R, c.G, c.B, c.A)
		}
	*/
	for i, line := range data {
		ut.AssertEqualIndex(t, i, line.expected, waveLength2RGB(line.input))
	}
}

func TestGradient(t *testing.T) {
	a := Color{10, 10, 10, 10}
	b := Color{20, 20, 20, 20}
	// TODO(maruel): Fix.
	testFrame(t, &Gradient{a, b}, expectation{0, []Color{{1, 1, 1, 30}}})
	testFrame(t, &Gradient{a, b}, expectation{0, []Color{{20, 20, 20, 20}, {10, 10, 10, 10}}})
	testFrame(t, &Gradient{a, b}, expectation{0, []Color{{20, 20, 20, 20}, {15, 15, 15, 15}, {10, 10, 10, 10}}})
}

//

type expectation struct {
	offset time.Duration
	colors []Color
}

func testFrames(t *testing.T, p Pattern, expectations []expectation) {
	pixels := make([]Color, len(expectations[0].colors))
	for frame, e := range expectations {
		p.NextFrame(pixels, e.offset)
		for j := range e.colors {
			a := e.colors[j]
			b := pixels[j]
			dR := int(a.R) - int(b.R)
			dG := int(a.G) - int(b.G)
			dB := int(a.B) - int(b.B)
			dA := int(a.A) - int(b.A)
			if dR > 1 || dR < -1 || dG > 1 || dG < -1 || dB > 1 || dB < -1 || dA > 1 || dA < -1 {
				t.Fatalf("frame=%d; pixel=%d; %v != %v", frame, j, a, b)
			}
		}
	}
}

func testFrame(t *testing.T, p Pattern, e expectation) {
	pixels := make([]Color, len(e.colors))
	p.NextFrame(pixels, e.offset)
	for j := range e.colors {
		a := e.colors[j]
		b := pixels[j]
		dR := int(a.R) - int(b.R)
		dG := int(a.G) - int(b.G)
		dB := int(a.B) - int(b.B)
		dA := int(a.A) - int(b.A)
		if dR > 1 || dR < -1 || dG > 1 || dG < -1 || dB > 1 || dB < -1 || dA > 1 || dA < -1 {
			t.Fatalf("pixel=%d; %v != %v", j, a, b)
		}
	}
}
